# E2Eテストシナリオ: 利用規約同意 (UC-001)

## 概要
利用規約同意フローに関するE2Eテストシナリオ

---

## シナリオ1: 初回アクセス時の利用規約同意ダイアログ表示

### 前提条件
- 利用規約に未同意（ローカルストレージに同意情報なし）
- シミュレーション作成画面（/simulate）にアクセス

### テストステップ（Given/When/Then）

**Given（前提）:**
- ブラウザのローカルストレージがクリアされている
- ユーザーがサービスに初めてアクセスする

**When（操作）:**
1. シミュレーション作成画面（/simulate）にアクセスする
2. 画像アップロードエリアを確認する

**Then（期待結果）:**
- 利用規約同意ダイアログが表示される
- 「利用規約に同意する」チェックボックスが表示される
- 「利用規約を読む」リンクが表示される
- 「同意して続ける」ボタンが非活性状態である
- 画像アップロードエリアが操作できない状態である

---

## シナリオ2: 利用規約への同意成功

### 前提条件
- 利用規約同意ダイアログが表示されている

### テストステップ（Given/When/Then）

**Given（前提）:**
- 利用規約同意ダイアログが表示されている
- 「同意して続ける」ボタンが非活性状態である

**When（操作）:**
1. 「利用規約に同意する」チェックボックスをクリックする
2. 「同意して続ける」ボタンをクリックする

**Then（期待結果）:**
- チェック後、「同意して続ける」ボタンが活性化される
- ボタンクリック後、ダイアログが閉じる
- 画像アップロードエリアが操作可能になる
- ローカルストレージに同意情報が保存される

---

## シナリオ3: 利用規約ページへのリンク遷移

### 前提条件
- 利用規約同意ダイアログが表示されている

### テストステップ（Given/When/Then）

**Given（前提）:**
- 利用規約同意ダイアログが表示されている

**When（操作）:**
1. 「利用規約を読む」リンクをクリックする

**Then（期待結果）:**
- 利用規約ページ（/terms）が新しいタブで開く、または同画面内で表示される
- 利用規約の本文が表示される

---

## シナリオ4: 同意済みユーザーの再アクセス

### 前提条件
- 過去に利用規約に同意済み（ローカルストレージに同意情報あり）

### テストステップ（Given/When/Then）

**Given（前提）:**
- ローカルストレージに同意情報が保存されている
- ブラウザを閉じて再度開く

**When（操作）:**
1. シミュレーション作成画面（/simulate）にアクセスする

**Then（期待結果）:**
- 利用規約同意ダイアログが表示されない
- 画像アップロードエリアがすぐに操作可能である

---

## シナリオ5: 同意せずに閉じようとした場合

### 前提条件
- 利用規約同意ダイアログが表示されている
- チェックボックスが未選択

### テストステップ（Given/When/Then）

**Given（前提）:**
- 利用規約同意ダイアログが表示されている

**When（操作）:**
1. ダイアログ外をクリックする（モーダルの場合）

**Then（期待結果）:**
- ダイアログは閉じない
- 画像アップロード機能は引き続き利用不可

---

## エラーケース

### E1: ローカルストレージが使用不可の場合

**Given（前提）:**
- ブラウザのローカルストレージが無効化されている

**When（操作）:**
1. 利用規約に同意する

**Then（期待結果）:**
- 同意は受け入れられ、セッション中は機能が使用可能
- ブラウザを閉じると同意状態がリセットされる（再度同意が必要）

---

## テストデータ
- なし（同意状態はローカルストレージで管理）

## 関連ユースケース
- UC-001: 利用規約への同意

## 関連画面
- SCR-002: シミュレーション作成画面
- SCR-007: 利用規約画面
